window.onerror=function(e,t,r,n,i){var s="";s+=i?i.stack.toString():"Message: "+e+"\nFile: "+t+"\nLine: "+r,"undefined"!=typeof verboseDebug&&$("<div></div>").css({background:"#fff",position:"absolute",left:0,top:0,padding:10,"white-space":"pre-wrap","z-index":100500,border:"1px solid #eee"}).text(s).appendTo(document.body)},$(document).on("mousedown","*",function(e){$(e.currentTarget).attr("data-browser-draggable")||(e.currentTarget.draggable=!1)}),$(document).on("mousedown","a",function(e){e.preventDefault();var t=$(e.currentTarget);/^(#|(javascript)|(\/$))/i.test(t.attr("href"))||t.attr("target")||t.attr("target","_blank")}),$(document).on("mousedown",".button, .control-button",function(e){var t=$(e.currentTarget);if(!t.hasClass("disabled")&&!t.hasClass("zd-ui-button")&&!t.hasClass("active")){var r=$(document),n=function(e){e.stopPropagation(),t.removeClass("active"),r.unbind("mouseup",i),t.unbind("mouseup",n)},i=function(e){e.stopPropagation(),t.removeClass("active"),t.removeClass("hover"),r.unbind("mouseup",i),t.unbind("mouseup",n)};r.bind("mouseup",i),t.addClass("active").bind("mouseup",n)}}),$(document).on("click","a",function(e){var t=$(e.currentTarget).attr("href");/^#/.test(t)&&(e.preventDefault(),/^#[\s\S]+/.test(t)&&$(window).trigger("hashset",{hash:t}))}),$window=$(window),document.addEventListener("click",function(e){for(var t,r=e.target,n=5;n-->0&&r;){if("A"===r.nodeName){if("string"!=typeof r.getAttribute("data-downloadable"))break;t=r.getAttribute("href"),/^#|(javascript)/i.test(t)||(e.preventDefault(),global.emit("DownloadUrl",{url:t}));break}r=r.parentNode}},!0),$(window).on("hashset",function(e,t){var r=window.location.href.split("#")[0]+(t.hash?t.hash.replace(/^#?/,"#"):"#");return t.force?(window.location.href=r,void(e.force=!0)):void window.setTimeout(function(){e.isImmediatePropagationStopped()||(window.location.href=r)},1)}).on("hashreplace",function(e,t){var r=window.location.href.split("#")[0]+(t.hash?t.hash.replace(/^#?/,"#"):"#");return t.force?(window.location.replace(r),void(e.force=!0)):void window.setTimeout(function(){e.isImmediatePropagationStopped()||window.location.replace(r)},1)}),function(){var e={},t=function(e,t){e&&(e=e.replace(/^\./,this.templatePrefix+".")),this._template="",this._dictionary=t||{},e&&this.setTemplate(e)};t.prototype={templatePrefix:"core",setDictionary:function(e){return this._dictionary=e,this},max:Math.max($.getScreenSize().w,$.getScreenSize().h),setTemplate:function(t){if(zd.templates[t]||this.getTemplates(t),e[t]=!0,zd.templates[t]){if(this._template=zd.templates[t],/^<!--import/.test(this._template))return t=this._template.replace(/^<!--import\s([\S]+)-->/,"$1"),this.setTemplate(t);"msie"===browser.agent&&browser.version>=9&&browser.version<10?this._template=this._template.replace(/<!--\[if IE 9\]>([\s\S]*?)<!\[endif\]-->/g,"$1").replace(/<!--\[if lt IE 9\]>[\s\S]*?<!\[endif\]-->/g,""):"msie"===browser.agent&&$.browser.version<9?this._template=this._template.replace(/<!--\[if IE 9\]>[\s\S]*?<!\[endif\]-->/g,"").replace(/<!--\[if lt IE 9\]>([\s\S]*?)<!\[endif\]-->/g,"$1"):this._template=this._template.replace(/<!--\[if IE 9\]>[\s\S]*?<!\[endif\]-->/g,"").replace(/<!--\[if lt IE 9\]>[\s\S]*?<!\[endif\]-->/g,""),this._template=this._template.replace(/<!--[\s\S]+?-->/g,""),this._template=this._template.replace(/<@([^\|@]+)\|?(.*?)@>/g,this.localization),this._template=this._template.trim().replace(/(>)[\s\n]+(<)/g,"$1$2").replace(/\n/g," "),this._template=this._template.replace(/'/g,"&#39;");var r=this.max;this._template=this._template.replace(/<svg[\s\S]*?<\/svg>/g,function(e){var t,n=new RegExp(' viewBox="([^"]+)"',"g");if(e=e.replace(n,function(e,n){var i=n.split(" "),s=i.reduce(function(e,t){return Math.max(parseFloat(e,10),parseFloat(t),10)});return s>5*r&&(t=s/(5*r)),e}),!t)return e;var i=function(e,r){if(/%$/.test(r))return e;var n=r.replace(/[0-9\.]+/g,function(e){return Math.round(1e4*parseFloat(e)/t)/1e4});return e.replace(r,n)},s=["viewBox","d","cx","cy","r","points","x","y"];return s.forEach(function(t){var r=new RegExp(" "+t+'="([^"]+)"',"g");e=e.replace(r,i)}),e})}else console.warn("Can't find template: "+t),this._template="";return this},getTemplates:function(t){if(t=t.replace(/^\./,this.templatePrefix+"."),e[t])return this;var r=t.split("."),n=function(){return"msie"===browser.agent&&9===browser.version?"/templates/js/"+r.shift():zd.config.get("cdn")+"/templates/js/"+r.shift()}(),i={namespace:r.join("."),disc:zd.config.get("templatesDisc"),lang:zd.config.get("lang")};return $.ajax({url:n,type:"get",data:$.param(i),dataType:"json",async:!1,success:function(r){if(r.error&&global.emit("ErrorController:FireError",{error:r.error}),r.result){for(var n in r.result){e[n]=!0;for(var i=n.split(".");i.pop();){var s=i.join(".");if(-1===s.indexOf(t))break;e[i.join(".")]=!0}}zd.templates=$.extend(zd.templates||{},r.result)}}.bind(this),error:function(e){this._getCounter||(this._getCounter=0),this._getCounter++,5!=this._getCounter?this.getTemplates(t):delete this._getCounter}.bind(this)}),this},localization:function(){return _.apply(window,$.merge([arguments[1]],JSON.parse("["+arguments[2]+"]")))},compile:function(e){var t=$.srender(this._template,$.extend({config:zd.config.get(),browser:browser},this._dictionary||{}));return e?t:$(t)}};var r=function(){this._storage=new TAFFY([]),this._storage.settings({cacheSize:0}),this._response=this._storage()};r.prototype={query:function(e){return e?this._response=this._storage(e):this._response=this._storage(),this},get:function(){return Array.prototype.slice.call(this._response.get())},first:function(){return this._response.first()},insert:function(e){return this._storage.insert(e),this},order:function(e){return this._response=this._response.order(e),this},filter:function(e){return this._response=this._response.filter(e),this},update:function(e){return this._response=this._response.update(e),this},remove:function(){return this._response.remove()},limit:function(e){return this._response=this._response.limit(e),this},start:function(e){return this._response=this._response.start(e),this},count:function(){return this._response.count()},min:function(e){return this._response.min(e)},max:function(e){return this._response.max(e)},sum:function(e){return this._response.sum(e)},distinct:function(){return this._response.distinct.apply(this._response,arguments)},getStorage:function(){return this._storage}};var n=function(){return new r},i={bind:function(e,t){return this.hasOwnProperty("listener")||(this.listener=$("<div></div>")),this.listener.bind(e,t),this},unbind:function(e,t){return this.hasOwnProperty("listener")?(this.listener.unbind(e,t),this):this},trigger:function(e,t){return this.hasOwnProperty("listener")?(this.listener.trigger(e,t),this):this},one:function(e,t){return this.hasOwnProperty("listener")||(this.listener=$("<div></div>")),this.listener.one(e,t),this}},s=function(){this.actions=[],this.methods=[],this.bind=function(e,t){this.actions.push(["bind",e,t])},this.unbind=function(e,t){this.actions.push(["unbind",e,t])},this.trigger=function(e,t){this.actions.push(["trigger",e,t])},this.init=function(){this.methods.push(["init",arguments])},this.enable=function(){this.methods.push(["enable",arguments])},this.disable=function(){this.methods.push(["disable",arguments])},this.destroy=function(){this.methods.push(["destroy",arguments])},this.resolve=function(e){for(var t,r;t=this.actions.shift();)e[t[0]](t[1],t[2]);for(;r=this.methods.shift();)e[r[0]].apply(e,r[1])}},o=function(){this.maxretry=5,this._modules={},this._libs={},this._models={},this._databases={}};o.prototype=$.extend({getModule:function(e){return this._modules[e]?this._modules[e]:(this._modules[e]=new s,this.loadModule(e),this._modules[e])},loadModule:function(e,t){t=t||1;for(var r,n,o=e.split("."),a=zd.modules,u=o.pop();r=o.shift();)void 0===a[r]&&(a[r]={}),a=a[r];if(a[u])n=a[u];else if(t>this.maxretry&&(console.warn("Can't find module: "+e),n=new s),t<=this.maxretry){var l=function(r){n=this.loadModule(e,++t)}.bind(this);$.ajax({url:"/static/source/js/modules/"+e.replace(/\./g,"/")+".js",type:"get",dataType:"script",async:!1,error:l,success:l})}if("new"!==n.EventEmitterType)for(var c in i)n[c]=i[c];return this._modules[e]instanceof s&&this._modules[e].resolve(n),n.bind("destroy",this.destroyModule.bind(this,e)),this._modules[e]=n,n},destroyModule:function(e,t){return t?void delete this._modules[e]:void this._modules[e].trigger("destroy")},getLib:function(e,t){if(t=t||1,!this._libs[e]){for(var r,n=e.split("."),s=zd.libs,o=null,a=n.pop();r=n.shift();)void 0===s[r]&&(s[r]={}),s=s[r];if(s[a])o=s[a];else if(t>this.maxretry)console.warn("Can't find lib: "+e),o=function(){},o.ptototype=i;else{var u=function(){o=this.getLib(e,++t)}.bind(this);$.ajax({url:"/static/source/js/libs/"+e.replace(/\./g,"/")+".js",type:"get",dataType:"script",async:!1,error:u,success:u})}if("new"!==o.prototype.EventEmitterType)for(var l in i)o.prototype[l]=i[l];this._libs[e]=o}return this._libs[e]},getModel:function(e,t){if(t=t||1,!this._models[e]){for(var r,n=e.split("."),s=zd.models,o=null,a=n.pop();r=n.shift();)void 0===s[r]&&(s[r]={}),s=s[r];if(s[a])o=s[a];else if(t>this.maxretry)console.warn("Can't find model: "+e),o=function(){},o.ptototype=i;else{var u=function(){o=this.getModel(e,++t)}.bind(this);$.ajax({url:"/static/source/js/models/"+e.replace(/\./g,"/")+".js",type:"get",dataType:"script",async:!1,error:u,success:u})}this._models[e]=o}return this._models[e]},getTemplate:function(e,r){return new t(e,r)},getTemplatesNamespace:function(e){(new t).getTemplates(e)},newDatabase:function(){return new n},getDatabase:function(e){return this._databases[e]?this._databases[e]:(this._databases[e]=this.newDatabase(),this._databases[e])},getEventModelObject:function(){return $.extend({},i)}},i),void 0===window.zd&&(window.zd={}),$.extend(window.zd,{core2:new o,modules:{},models:{},libs:{},utils:{tabHashMaker:function(e,t){t="#"+t;for(var r in e)t=t.replace(r,e[r]);return t},sizeConverter:function(e,t){return zd.core3.require("core/utils/ui/sizeConverter").apply(this,arguments)},dateConverter:function(){return zd.core3.require("core/utils/ui/dateConverter").apply(this,arguments)},timeConverter:function(e){return zd.core3.require("core/utils/ui/timeConverter").apply(this,arguments)},numberConverter:function(e){return 1e3>e?e:"1k+"},durationConverter:function(e){var t=0,r=0,n=0,i="";return t=Math.floor(e/3600),e-=3600*t,i+=t+":",r=Math.floor(e/60),e-=60*r,10>r&&(i+=0),i+=r+":",n=e,10>n&&(i+=0),i+=n,i.trim()},intersection:function(){var e=Array.prototype.slice.call(arguments);if(!e[0])return[];var t,r,n,i=e[0].slice();for(t=1,r=e.length;r>t;t++){if(n=[],e[t].forEach(function(e){i.indexOf(e)>-1&&n.push(e)}),!n.length)return[];i=n}return i},setTextSelection:function(e){var t,r,n=document;n.body.createTextRange?(t=n.body.createTextRange(),t.moveToElementText(e),t.select()):window.getSelection&&(r=window.getSelection(),t=n.createRange(),t.selectNodeContents(e),r.removeAllRanges(),r.addRange(t))},setInputSelection:function(e,t,r){return zd.core3.require("core/utils/ui/setInputSelection").apply(this,arguments)},getInputSelection:function(e){return zd.core3.require("core/utils/ui/getInputSelection").apply(this,arguments)},titleSplit:function(e){if("ff"!==browser.agent)return e;e=e.split(/ /);var t,r,n,i=50;for(r=0,n=e.length;n>r;r++)for(;(t=e[r]).length>i;)e[r]=t.substr(i),e.splice(r,0,t.substr(0,i)),r++,n++;return e.join(" ")},getScrollBarWidth:function(){return zd.core3.require("core/utils/ui/getScrollBarWidth").apply(this,arguments)},escape:function(){return zd.core3.require("core/utils/ui/escape").apply(this,arguments)},unescape:function(e){return e.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&")},switchClass:function(e,t,r,n){return n=$.extend({animated:!0,duration:200,queue:!0,step:function(){},complete:function(){}},n||{}),n.complete=function(n,i){return function(){var s=n();return e.removeAttr("style").addClass(r).removeClass(t),i(),s}}(n.complete,n.step),n.animated?(e.each(function(){var e=getComputedStyle(this),i=$(this);i.removeAttr("style").addClass(t).removeClass(r);var s=$.extend({},e);i.addClass(r).removeClass(t);var o=$.extend({},e);i.addClass(t).removeClass(r);var a={};for(var u in o)s[u]!==o[u]&&(a[u]=o[u]);return 0===Object.keys(a).length?(n.step(),i.addClass(r).removeClass(t)):void i.animate(a,n)}),e):(n.step(),e.addClass(r).removeClass(t))},toDashSeparated:function(e){return e.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()}).replace(/^\-/,"")},toFileName:function(e){var t=zd.utils.escape(e),r="",n=t.split(".");return n.length>1?(r=n.pop(),n.join(".")+'<span class="extension">.'+r+"</span>"):t},parseLinks:function(e){return e.replace(/(\s|^)((?:(?:(?:http|https|ftp):\/\/)|(?:www\.))[^\s"']+)/g,function(e,t,r){var n=r;return 0===n.indexOf("www")&&(n="http://"+r),t+'<a href="'+n+'" target="_blank">'+r+"</a>"})},extend:function(){return zd.core3.require("core/utils/extend").apply(this,arguments)},inherits:function(){return zd.core3.require("core/utils/inherits").apply(this,arguments)},"implements":function(){return zd.core3.require("core/utils/implements").apply(this,arguments)},uid:function(){return zd.core3.require("core/utils/uid").apply(this,arguments)},$super:function a(e){var t=a.caller||arguments.callee.caller;return zd.core3.require("core/utils/$super").call(this,e,t)},isNode:function(e){return e instanceof jQuery},getEmptyNode:function(){return $("<div></div>")},insertSVGText:function(){var e="http://www.w3.org/2000/svg";return function(t,r,n){if(t&&t.hasChildNodes){for(;t.hasChildNodes();)t.removeChild(t.firstChild);if("safari"===browser.agent&&browser.version<7){var i=document.createElementNS(e,"tspan"),s=document.createTextNode(r.join(""));return i.appendChild(s),void t.appendChild(i)}for(var o=0,a=r.length;a>o;o++){var i=document.createElementNS(e,"tspan"),u=n&&n[o],s=document.createTextNode(r[o]);if("object"==typeof u)for(var l in u)u.hasOwnProperty(l)&&i.setAttributeNS(null,l,u[l]);i.appendChild(s),t.appendChild(i)}return t}}}(),getDownloadButtonDictionary:function(){return zd.core3.require("core/utils/ui/getDownloadButtonDictionary").apply(this,arguments)},binarySearch:function(e,t){var r=e.length;return function n(r,i,s){if(2>s-i||2>i-r){for(var o=e[r],a=Math.abs(o-t),u=r,l=r+1;s>=l;l++){var c=e[l],p=Math.abs(c-t);a>p&&(o=c,a=p,u=l)}return{value:o,index:u}}return e[i]<t?n(i,Math.floor(i+(s-i)/2),s):e[i]>t?n(r,Math.floor(r+(i-r)/2),i):{value:e[i],index:i}}(0,Math.floor(r/2),r-1)},createElementTitle:function(e){if("ff"!==browser.agent)return e;e=e.toString().split(" ");var t=[];return e.forEach(function(e){for(;e.length>0;)t.push(e.substr(0,50)),e=e.substr(50)}),t.join(" ")},param:function(e){return zd.core3.require("core/utils/param").apply(this,arguments)},isCanPDFView:function(){var e=function(){if("msie"===browser.agent){var e=null;try{return e=new ActiveXObject("AcroPDF.PDF"),!0}catch(t){}if(!e)try{return e=new ActiveXObject("PDF.PdfCtrl"),!0}catch(t){}return!1}var r=navigator.mimeTypes;if(r&&r.length>0)for(var n=0,i=r.length;i>n;n++)if("application/pdf"===r[n].type)return!0;return"ff"===browser.agent},t=null;return function(){return null!==t?t:e()}}(),svgToSrc:function(e){return"data:image/svg+xml;base64,"+Base64.encode(e)},parseMouseWheelEvent:function(e){e=e.originalEvent;var t=0,r=0;return void 0!==e.wheelDeltaX?(t=e.wheelDeltaX/40,r=e.wheelDeltaY/40):e.detail?(t=1===e.axis?-e.detail:0,r=2===e.axis?-e.detail:0):void 0!==e.deltaX&&(t=-e.deltaX/4,r=-e.deltaY/4),{deltaX:t,deltaY:r}},scrollIntoView:function(e,t){for(var r,n,i=0,s=e.offsetHeight,o=e.scrollTop,a=t.offsetHeight;t&&!t.isEqualNode(e);)i+=t.offsetTop,t=t.offsetParent;((r=o>i)||(n=i+a-o>s))&&(r&&(e.scrollTop=i),n&&(a>s?e.scrollTop=i:e.scrollTop=o+(i+a-(o+s))))}}})}(),function(){var e=function(e,t,r){var n,i,s,o;if(e=e.toLowerCase(),t=t.toLowerCase(),"normalasc"===r||"normaldesc"===r)return t>e?"normalasc"===r?-1:1:e>t?"normalasc"===r?1:-1:0;n=function(){for(var t,r=[],n=/((?:(?:[^0-9]+)|^))(?:([0-9]+)|$)/g;t=n.exec(e);)""!==t[1]&&void 0!==t[1]&&r.push({v:t[1],l:t[1].length}),void 0!==t[2]&&r.push({v:parseInt(t[2],10),l:t[2].length});return r}(),s=function(){for(var e,r=[],n=/((?:(?:[^0-9]+)|^))(?:([0-9]+)|$)/g;e=n.exec(t);)""!==e[1]&&void 0!==e[1]&&r.push({v:e[1],l:e[1].length}),void 0!==e[2]&&r.push({v:parseInt(e[2],10),l:e[2].length});return r}();for(var a=0,u=n.length;u>a;a++){if(void 0===s[a])return"asc"===r?1:-1;if(i=n[a].v,o=s[a].v,i!==o)return typeof i!=typeof o&&(i+="",o+=""),o>i?"asc"===r?-1:1:"asc"===r?1:-1;if(n[a].l!==s[a].l)return"asc"===r?s[a].l-n[a].l:n[a].l-s[a].l}return s[a]?"asc"===r?-1:1:0},t=function(e,t,r){return t>e?"asc"===r?-1:1:e>t?"asc"===r?1:-1:0};zd.utils.sortArray=function(r,n){n=n.replace(/asec/g,"asc");var i=n.split(/[\s]*,[\s]*/);return r.sort(function(r,n){for(var s=0,o=i.length;o>s;s++){var a=i[s].split(/[\s]+/),u=r[a[0]],l=n[a[0]],c=(a[1]||"asc").toLowerCase();if(void 0!==u&&void 0!==l){if(Object(u)instanceof String&&Object(l)instanceof String){if(u===l)continue;return e(u,l,c)}if(Object(u)instanceof Number&&Object(l)instanceof Number){if(u===l)continue;return t(u,l,a[1])}if(u===l)continue;return e(u.toString(),l.toString(),c)}}return 0}),r}}();
